<!doctype html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>We welcome you</title>
	<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="css/signup.css">
</head>
<script>
function joinGibblabber(){
	var username=document.getElementById('username').value;
	var email=document.getElementById('email').value;
	var gender=document.getElementById('gender').value;
	var password=document.getElementById('password').value;
	var confirmPassword=document.getElementById('cfmpassword').value;
	if(username==='' || email==='' || gender==='' || password==='' || confirmPassword===''){
		alert('Please fill the fields');
		return;
	}
	if(password!==confirmPassword){
		alert('Passwords are not matching');
		return;
	}
	var json={};
  json.username=username;
	json.email=email;
	json.gender=gender;
	json.password=window.btoa(password);
	json.functionIdentifier=window.btoa('account creation');
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
    var resultSet=JSON.parse(this.responseText);
    if(JSON.parse(resultSet.status)){
      if(resultSet.data=='Duplicate'){
				alert('Username or Email already used for gibblabber registration.');
			}
			else if(resultSet.data=='Success'){
				alert('Welcome to gibblabber. You have successfully registered');
				location.href='/login';
			}
    }
  }

  };
  xhttp.open("POST","http://localhost:8080/createuser ", true);
  xhttp.setRequestHeader("Content-type", "application/json");
  xhttp.send(JSON.stringify(json));
  }

</script>
<body>
  <div class="col-md-12 login">
		<div class="col-md-12 username">
    	<span class="username_span">
				Username
			</span>
			<input type='text' id="username">
			</input>
		</div>
		<div class="col-md-12 email">
    	<span class="email_span">
				Email Id
			</span>
			<input type='text' id="email">
			</input>
		</div>
		<div class="col-md-12 gender">
    	<span class="gender_span">
				Gender
			</span>
			<select id="gender">
  			<option value="male">Male</option>
  			<option value="female">Female</option>
				<option value="others">Others</option>
				<option value="notreveal">Wish not to answer</option>
			</select>
		</div>

		<div class="col-md-12 password">
    	<span class="password_span">
				Password
			</span>
			<input type='password' id="password">
			</input>
		</div>

		<div class="col-md-12 cfmpassword">
    	<span class="cfmpassword_span">
				Confirm Password
			</span>
			<input type='password' id="cfmpassword">
			</input>
		</div>
		<div class="col-md-12 login_button">
			<button type="button" onclick="joinGibblabber()">Join Gibblabber</button>
		</div>
  </div>
</body>
</html>
